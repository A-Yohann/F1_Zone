{% extends 'base.html.twig' %}

{% block title %}Hello HomeController!{% endblock %}

{% block body %}
<style>
    .example-wrapper { margin: 1em auto; max-width: 800px; width: 95%; font: 18px/1.5 sans-serif; }
    .example-wrapper code { background: #F5F5F5; padding: 2px 6px; }
</style>

<section>
    <div class="hero">
        <div>
            <img src="{{ asset('assets/img/ferrari-hero-1.webp')}}" alt="image de la page d'accueil">
        </div>
        <h1>Bienvenue sur F1 Zone !</h1>
        <p>Vivez la Formule 1 à pleine vitesse.</p>
    </div>
</section>

{# cards actus #}
<section>
    <h2>Actualitées</h2>
    <div class="news-cards">
        <a href="{{ path('gp_resume') }}" class="news-card">
            <h3>Resumé des GP</h3>
            <img src="{{ asset('assets/img/news1.jpg') }}" alt="Image actu 1">
        </a>
        <a href="#" class="news-card">
            <h3>Transfert pilotes</h3>
            <img src="{{ asset('assets/img/pilotes-grp.webp') }}" alt="Image actu 2">
        </a>
        <a href="{{ path('app_reglementation_fia') }}" class="news-card">
            <h3>Nouvelle reglementation</h3>
            <img src="{{ asset('assets/img/Fia-logo.jpg') }}" alt="Image actu 3">
        </a>
        <a href="#" class="news-card">
            <h3>dernier vainqueur</h3>
            <img src="{{ asset('assets/img/japon-verstappen.jpg') }}" alt="Image actu 4">
        </a>
    </div>
</section>

{# section pilotes #}
<section>
    <h2>Les pilotes</h2>
    {% set pilotes_top = pilotes|slice(0,5) %}
    {% set pilotes_bottom = pilotes|slice(5,5) %}
    <div class="pilotes-cards">
        {% for pilote in pilotes_top %}
            <div class="pilote-card">
                <img src="{{ asset('assets/img/' ~ (pilote.photo ?: 'pilotes-grp.webp')) }}" alt="Photo de {{ pilote.prenom }} {{ pilote.nom }}">
                <div class="pilote-info">
                    <h3>{{ pilote.prenom }} {{ pilote.nom }}</h3>
                    <div class="ecurie">{{ pilote.ecurie ? pilote.ecurie.nom : 'Sans écurie' }}</div>
                    <a href="#" class="profil-btn">Voir Profil</a>
                </div>
            </div>
        {% endfor %}
    </div>
    <div class="pilotes-cards">
        {% for pilote in pilotes_bottom %}
            <div class="pilote-card">
                <img src="{{ asset('assets/img/' ~ (pilote.photo ?: 'pilotes-grp.webp')) }}" alt="Photo de {{ pilote.prenom }} {{ pilote.nom }}">
                <div class="pilote-info">
                    <h3>{{ pilote.prenom }} {{ pilote.nom }}</h3>
                    <div class="ecurie">{{ pilote.ecurie ? pilote.ecurie.nom : 'Sans écurie' }}</div>
                    <a href="#" class="profil-btn">Voir Profil</a>
                </div>
            </div>
        {% endfor %}
    </div>
</section>

{# section classement #}
<section id="classement">
    <h2>Classements</h2>

    <form method="get" action="#classement" class="gp-filter-form" style="margin-bottom:1.5rem;">
        <label for="grand_prix">Filtrer par Grand Prix :</label>
        <select name="grand_prix" id="grand_prix" onchange="this.form.submit()">
            <option value="">Classement général</option>
            {% for gp in grand_prix_list %}
                <option value="{{ gp }}" {% if gp == selected_gp %}selected{% endif %}>{{ gp }}</option>
            {% endfor %}
        </select>
    </form>

    <div class="classement-flex">
        <div class="classement-box">
            <div class="classement-title">Classement pilotes</div>
            <table class="classement-table">
                <tbody>
                {% for pilote in classement_pilotes|slice(0,3) %}
                    <tr>
                        <td>#{{ loop.index }}</td>
                        <td>{{ pilote.prenom }} {{ pilote.nom }}</td>
                        <td class="pts">{{ pilote.totalPoints }} pts</td>
                    </tr>
                {% endfor %}
                </tbody>
                <tbody id="all-pilotes" style="display:none;">
                {% for pilote in classement_pilotes|slice(3) %}
                    <tr>
                        <td>#{{ loop.index + 3 }}</td>
                        <td>{{ pilote.prenom }} {{ pilote.nom }}</td>
                        <td class="pts">{{ pilote.totalPoints }} pts</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <button class="toggle-btn" onclick="toggleClassement('all-pilotes', this)">▼</button>
        </div>
        <div class="classement-box">
            <div class="classement-title">Classement constructeur</div>
            <table class="classement-table">
                <tbody>
                {% for ecurie in classement_ecuries|slice(0,3) %}
                    <tr>
                        <td>#{{ loop.index }}</td>
                        <td>{{ ecurie.nom }}</td>
                        <td class="pts">{{ ecurie.totalPoints }} pts</td>
                    </tr>
                {% endfor %}
                </tbody>
                <tbody id="all-ecuries" style="display:none;">
                {% for ecurie in classement_ecuries|slice(3) %}
                    <tr>
                        <td>#{{ loop.index + 3 }}</td>
                        <td>{{ ecurie.nom }}</td>
                        <td class="pts">{{ ecurie.totalPoints }} pts</td>
                    </tr>
                {% endfor %}
                </tbody>
            </table>
            <button class="toggle-btn" onclick="toggleClassement('all-ecuries', this)">▼</button>
        </div>
    </div>

    <script>
    function toggleClassement(id, btn) {
        const tbody = document.getElementById(id);
        if (tbody.style.display === 'none') {
            tbody.style.display = '';
            btn.textContent = '▲';
        } else {
            tbody.style.display = 'none';
            btn.textContent = '▼';
        }
    }
    </script>
</section>

{% endblock %}